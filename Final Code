CREATE TABLE Movie (
    MovieID         INT PRIMARY KEY,
    Title           VARCHAR(50),
    ReleaseYear     INT,
    MovieRating     DECIMAL(3,2),
    AudienceRec     VARCHAR(10),
    Language        VARCHAR(15)
);

CREATE TABLE Genre (
    Genre       VARCHAR(15),
    MovieID     INT PRIMARY KEY,
    FOREIGN KEY (MovieID) REFERENCES Movie(MovieID) ON DELETE CASCADE
);

CREATE TABLE Actor (
    ActorID     VARCHAR(30) PRIMARY KEY,
    ActorName   VARCHAR(30),
    Birthday    DATE
);

CREATE TABLE MovieActor (
    ActorID     VARCHAR(30),
    MovieID     INT,
    PRIMARY KEY (ActorID, MovieID),
    FOREIGN KEY (ActorID) REFERENCES Actor(ActorID) ON DELETE CASCADE,
    FOREIGN KEY (MovieID) REFERENCES Movie(MovieID) ON DELETE CASCADE
);

CREATE TABLE Production (
    DistributionCompany    VARCHAR(30),
    Director               VARCHAR(30),
    MovieID                INT PRIMARY KEY,
    FOREIGN KEY (MovieID) REFERENCES Movie(MovieID) ON DELETE CASCADE
);


drop table Actor;
drop table Production;
drop table Genre;
drop table Movie;

INSERT INTO Movie VALUES
(1, "A Simple Favor", 2018, 6.8, "R", "English"),
(2, "A Madea Homecoming", 2020, 5.7, "TV-MA", "English"),
(3, "Bad Boys", 1995, 6.8, "R", "English"),
(4, "Bad Boys II", 2003, 6.6, "R", "English"),
(5, "Big Time Movie", 2012, 6.2, "PG", "English"),
(6, "Carry-On", 2024, 6.5, "PG-13", "English"),
(7, "Clifford the Big Red Dog", 2021, 5.9, "PG", "English"),
(8, "Dangerous Lies", 2020, 5.4, "TV-14", "English"),
(9, "Dumplin", 2018, 6.5, "PG-13", "English"),
(10, "Dune: Part One", 2021, 8.0, "PG-13", "English"),
(11, "Dune: Part Two", 2024, 8.5, "PG-13", "English"),
(12, "First Daughter", 2004, 5.2, "PG", "English"),
(13, "Friends with Benefits", 2011, 6.5, "R", "English"),
(14, "Friends with Money", 2006, 5.8, "R", "English"),
(15, "Hanna", 2011, 6.7, "PG-13", "English"),
(16, "Heroin(e)", 2017, 6.8, "TV-14", "English"),
(17, "I Am Mother", 2019, 6.7, "PG", "English"),
(18, "Hustle", 2022, 7.3, "R", "English"),
(19, "Hubie Halloween", 2020, 5.3, "PG-13", "English"),
(20, "It Ends with Us", 2024, 6.4, "PG-13", "English"),
(21, "I Am Woman", 2019, 6.6, "TV-MA", "English"),
(22, "Despicable Me", 2010, 7.6, "PG", "English"),
(23, "Despicable Me 2", 2013, 7.3, "PG", "English"),
(24, "Definitely, Maybe", 2008, 7.1, "PG-13", "English"),
(25, "Death Note", 2017, 4.5, "TV-MA", "English"),
(26, "Easy A", 2010, 7.0, "PG-13", "English"),
(27, "Enola Holmes", 2020, 6.6, "PG-13", "English"),
(28, "Enola Holmes 2", 2022, 6.8, "PG-13", "English"),
(29, "Do Revenge", 2022, 6.3, "TV-MA", "English"),
(30, "Ella Enchanted", 2004, 6.3, "PG", "English"),
(31, "Descendant", 2022, 7.1, "PG", "English"),
(32, "Goosebumps", 2015, 6.3, "PG", "English"),
(33, "Chasing Coral", 2017, 8, "PG", "English"),
(34, "Ferris Bueller's Day Off", 1986, 7.8, "PG-13", "English"),
(35, "Jack Whitehall: At large", 2017, 6.9, "TV-MA"),
(36, "Jack Whitehall: Christmas with my father", 2019, 6.0, "TV-MA"),
(37, "John Mulaney: Baby J", 2023, 7.5, "TV-MA"),
(38, "John Mulaney: Kid Gorgeous at Radio City", 2018, 7.9, "TV-MA"),
(39, "John Mulaney: New in Town", 2012, 8.2, "TV-MA"),
(40, "John Mulaney: The comeback kid", 2015, 7.9, "TV-MA"),
(41, "Kate", 2021, 6.3, "R"),
(42, "King Kong", 2005, 7.2, "R"),
(43, "Land of Bad", 2024, 6.6, "R"),
(44, "Leave the world behind", 2023, 6.4, "R"),
(45, "Lift", 2024, 5.5, "PG-13"),
(46, "Little Evil", 2017, 5.7, "TV-MA"),
(47, "London has Fallen", 2016, 5.9, "R"),
(48, "Lonely Planet", 2024, 5.7, "R"),
(49, "Ma", 2019, 5.6, "R"),
(50, "Mad Max: Fury Road", 2015, 8.1, "R"),
(51, "Mary", 2024, 5.2, "TV-14"),
(52, "Message from the King", 2016, 6.4, "TV-MA"),
(53, "Migration", 2023, 6.6, "PG"),
(54, "Mile 22", 2018, 6.1, "R"),
(55, "Minions", 2015, 6.4, "PG"),
(56, "Minions: The rise of Gru", 2022, 6.5, "PG"),
(57, "Nobody sleeps in the woods tonight", 2020, 4.9, "TV-MA"),
(58, "Notting Hill", 1999, 7.2, "PG-13"),
(59, "Persuasion", 2022, 5.8, "PG"),
(60, "Peter Rabbit", 2018, 6.6, "PG"),
(61, "Pride and Prejudice", 2005, 7.8, "PG"),
(62, "Public Enemies", 2009, 6.9, "R"),
(63, "Race", 2016, 7.1, "PG-13"),
(64, "Rambo", 2008, 7.0, "R"),
(65, "Rebel Ridge", 2024, 6.8, "TV-MA"),
(66, "Red Notice", 2021, 6.3, "PG-13"),
(67, "Richie Rich", 1994, 5.4, "PG"),
(68, "Schindler's List", 1993, 9.0, "R"),
(69, "Scooby-Doo", 2002, 5.3, "PG"),
(70, "Scooby-Doo 2: Monsters Unleased", 2004, 5.3, "PG"),
(71, "Secret Obsession", 2019, 4.5, "TV-14"),
(72, "Senna", 2010, 8.5, "PG-13"),
(73, "Space Jam", 1996, 6.5, "PG"),
(74, "Spider-Man 3", 2007, 6.3, "PG-13"),
(75, "Superbad", 2007, 7.6, "R"),
(76, "Takers", 2010, 6.2, "PG-13"),
(77, "The Autopsy of Jane Doe", 2016, 6.8, "R"),
(78, "The Babadook", 2014, 6.5, "PG-13"),
(79, "The Christmas Chronicles", 2018, 7.1, "PG"),
(80, "The Fast and the Furious", 2001, 6.7, "TV-MA"),
(81, "The Fast and the Furious: Tokyo Drift", 2006, 6.2, "R"),
(82, "The Karate Kid", 1984, 7.2, "PG"),
(83, "The Karate Kid Part II", 1986, 6.0, "PG"),
(84, "The Karate Kid Part III", 1989, 5.2, "PG"),
(85, "The Kindergarten Teacher", 2018, 6.7, "R"),
(86, "The Prince of Egypt", 1998, 7.1, "PG"),
(87, "The Trial of the Chicago 7", 2020, 8.0, "R"),
(88, "To All the Boys I've Loved Before", 2018, 7.2, "TV-14"),
(89, "To All the Boys: P.S. I Still Love You", 2020, 6.0, "TV-14"),
(90, "Wanted", 2008, 6.4, "PG-13"),
(91, "What Happened to Monday", 2017, 6.9, "TV-MA"),
(92, "Your Son", 2018, 6.1, "TV-MA"),
(93, "Zero", 2018, 5.5, "TV-14"),
(94, "Zion", 2018, 7.2, "PG"),
(95, "Zombieland", 2009, 7.6, "R"),
(96, "Zookeeper", 2011, 5.2, "PG"),
(97, "This Christmas", 2007, 6.3, "PG-13"),
(98, "The Week Of", 2018, 5.1, "TV-14"),
(99, "The White Helmets", 2016, 7.5, "TV-14"),
(100, "The Ritual", 2017, 6.3, "TV-MA"),
(101, "The Silence", 2019, 5.4, "PG-13");

INSERT INTO Genre VALUES
("Comedy", 1),
("Drama", 2),
("Thriller", 3),
("Thriller", 4),
("Comedy", 5),
("Action", 6),
("Comedy", 7),
("Thriller", 8),
("Comedy", 9),
("Action", 10),
("Action", 11),
("Romantic Comedy", 12),
("Romantic Comedy", 13),
("Comedy", 14),
("Action", 15),
("Documentary", 16),
("Drama", 17),
("Comedy", 18),
("Comedy", 19),
("Drama", 20),
("Biography", 21),
("Adventure", 22),
("Adventure", 23),
("Romantic Comedy", 24),
("Horror", 25),
("Romantic Comedy", 26),
("Adventure", 27),
("Adventure", 28),
("Comedy", 29),
("Comedy", 30),
("Documentary", 31),
("Adventure", 32),
("Documentary", 33),
("Comedy", 34),
("Comedy", 35),
("Comedy", 36),
("Comedy", 37),
("Comedy", 38),
("Comedy", 39),
("Comedy", 40),
("Action", 41),
("Adventure", 42),
("Action", 43),
("Thriller", 44),
("Action", 45),
("Horror", 46),
("Action", 47),
("Romance", 48),
("Horror", 49),
("Action", 50),
("Drama", 51),
("Action", 52),
("Adventure", 53),
("Action", 54),
("Adventure", 55),
("Adventure", 56),
("Horror", 57),
("Romance", 58),
("Drama", 59),
("Comedy", 60),
("Drama", 61),
("Action", 62),
("Drama", 63),
("Action", 64),
("Action", 65),
("Action", 66),
("Comedy", 67),
("History", 68),
("Adventure", 69),
("Adventure", 70),
("Crime", 71),
("Biography", 72),
("Adventure", 73),
("Action", 74),
("Comedy", 75),
("Crime", 76),
("Horror", 77),
("Horror", 78),
("Adventure", 79),
("Action", 80),
("Action", 81),
("Action", 82),
("Action", 83),
("Action", 84),
("Drama", 85),
("Action", 86),
("Drama", 87),
("Romantic Comedy", 88),
("Romantic Comedy", 89),
("Action", 90),
("Action", 91),
("Drama", 92),
("Comedy", 93),
("Biography", 94),
("Comedy", 95),
("Comedy", 96),
("Comedy", 97),
("Comedy", 98),
("Documentary", 99),
("Horror", 100),
("Horror", 101);

INSERT INTO Production VALUES
("Lionsgate", "Paul Feig", 1),
("Netflix", "Tyler Perry", 2),
("Sony Pictures Releasing", "Michael Bay", 3),
("Sony Pictures Releasing", "Michael Bay", 4),
("Nickelodeon", "Savage Steve Holland", 5),
("Netflix", "Jaume Collet-Serra", 6),
("Paramount Pictures","Walt Becker", 7),
("Netflix", "Michael M. Scott", 8),
("Netflix", "Anne Fletcher", 9),
("Warners Bros. Pictures", "Denis Villeneuve", 10),
("Warners Bros. Pictures", "Denis Villeneuve", 11),
("20th Century Fox", "Forest Whitaker", 12),
("Sony Pictures Releasing", "Will Gluck", 13),
("Sony Pictures Classics", "Nicole Holofcener", 14),
("Focus Features", "Joe Wright", 15),
("Netflix", "Elaine McMillion Sheldon", 16),
("Netflix", "Grant Sputore", 17),
("Netflix", "Jeremiah Zagar", 18),
("Netflix", "Steven Brill", 19),
("Sony Pictures Releasing", "Justin Baldoni", 20),
("Stan", "Unjoo Moon", 21),
("Universal Pictures", "Pierre Cofflin", 22),
("Universal Pictures", "Pierre Cofflin", 23),
("Universal Pictures", "Adam Brooks", 24),
("Netflix", "Adam Wingard", 25),
("Sony Pictures Releasing", "Will Gluck", 26),
("Netflix", "Harry Bradbeer", 27),
("Netflix", "Harry Bradbeer", 28),
("Netflix", "Jennifer Kaytin Robinson", 29),
("Miramax Films", "Tommy O'Haver", 30),
("Netflix", "Margaret Brown", 31),
("Sony Pictures Releasing", "Rob Letterman", 32),
("Netflix", "Jeff Orlowski-Yang", 33),
("Paramount Pictures", "John Hughes", 34),
("Brian Klein", 35),
("Yemisi Brookes", 36),
("Alex Timbers", 37),
("Alex Timbers", 38),
("Ryan Polito", 39),
("Rhys Thomas", 40),
("Cedric Nicolas-Troyan", 41),
("Peter Jackson", 42),
("William Eubank", 43),
("Sam Esmail", 44),
("F. Gary Gary", 45),
("Eli Craig", 46),
("Babak Najafi", 47),
("Susannah Grant", 48),
("Tate Taylor", 49),
("George Miller", 50),
("D.J. Caruso", 51),
("Fabrice du Welz", 52),
("Benjamin Renner", 53),
("Peter Berg", 54),
("Kyle Balda", 55),
("Kyle Balda", 56),
("Bartosz M Kowalski", 57),
("Roger Michell", 58),
("Carrie Cracknell", 59),
("Will Gluck", 60),
("Joe Wright", 61),
("Michael Mann", 62),
("Stephen Hopkins", 63),
("Sylvester Stallone", 64),
("Jeremy Saulnier", 65),
("Rawson Marshall Thurber", 66),
("Donald Petrie", 67),
("Steven Spielberg", 68),
("Raja Gosnell", 69),
("Raja Gosnell", 70),
("Peter Sullivan", 71),
("Asif Kapadia", 72),
("Joe Pytka", 73),
("Sam Raimi", 74),
("Greg Mottola", 75),
("John Luessenhop", 76),
("André Øvredal", 77),
("Jennifer Kent", 78),
("Clay Kaytis", 79),
("Rob Cohen", 80),
("Justin Lin", 81),
("John G. Avildsen", 82),
("John G. Avildsen", 83),
("John G. Avildsen", 84),
("Sara Colangelo", 85),
("Brenda Chapman", 86),
("Aaron Sorkin", 87),
("Susan Johnson", 88),
("Michael Fimognari", 89),
("Timur Bekmambetov", 90),
("Tommy Wirkola", 91),
("Miguel Ángel Vivas", 92),
("Aanand L. Rai", 93),
("Floyd Russ", 94),
("Ruben Fleischer", 95),
("Frank Coraci", 96),
("Preston A. Whitmore II", 97),
("Robert Smigel", 98),
("Orlando von Einsiedel", 99),
("David Bruckner", 100),
("John R. Leonetti", 101);


//Note: (date format: 'Year-MM-DD')
INSERT INTO Actor VALUES 
(1, “Aaron Eckhart”, '1968-03-12'),
(2, “Aaron Pierre”, '1994-06-07'),
(3, “Abigail Breslin”, '1996-04-14'),
(4, “Adam Sandler”, '1966-09-09'),
(5, “Adam Scott”, '1973-04-03'),
(6, “Adrien Brody”, '1973-04-14'),
(7, “Alan Arkin”, '1934-03-26'),
(8, “Alan Ruck”, '1956-07-01'),
(9, “Alex Sharp”, '1989-02-02'),
(10, “Alfred Molina”),
(11, “Amanda Bynes”),
(12,“Amanda Walsh”),
(13, “Ana Wagener”),
(14, “Andrew Ackerman”),
(15, “Angelina Jolie”),
(16, “Anna Kendrick”),
(17, “AnnaSophia Robb”),
(18, “Anne Hathaway”),
(19, “Anthony Hopkins”),
(20, “Anushka Sharma”),
(21, “Arsher Ali”),
(22, “Asia Ortega”),
(23, “Ato Blankson-Wood”),
(24, “Austin Abrams”),
(25, “Ayrton Senna”),
(26, “Ben Kingsley”),
(27, “Benjamin Bratt”),
(28, “Blake Lively”),
(29, “Brenda Blethyn”),
(30, “Brenda Song”),
(31, “Brian Cox”),
(32, “Camila Mendes”),
(33, “Carlos PenaVega”),
(34, “Carole Shelley”),
(35, “Cary Elwes”),
(36, “Cassi Davis”),
(37, “Cate Blanchett”),
(38, “Catherine Keener”),
(39, “Chadwick Boseman”),
(40, “Charlie Evans”),
(41, “Charlize Theron”),
(42, “Chris Davis”),
(43, “Chris Diamantopoulos”),
(44, “Chris Rock”),
(45, “Christian Bale”),
(46, “Christopher Mintz-Plasse”),
(47, “Cosmo Jarvis”),
(48, “Dakota Johnson”),
(49, “Dana Abed”),
(50, “Danielle Macdonald”),
(51, “Danny Kamekona”),
(52, “Darby Camp”),
(53, “David Mann”),
(54, “David Thewlis”),
(55, “Delroy Lindo”),
(56, “Dennis Haysbert”),
(57, “Diana Silvers”),
(58, “Domhnall Gleeson”),
(59, “Don Johnson”),
(60, “Dwayne Johnson”),
(61, “Dylan Minnette”),
(62, “Eddie Redmayne”),
(63, “Edward Herrmann”),
(64, “Eli Goree”),
(65, “Elisabeth Shue”),
(66, “Elizabeth Banks”),
(67, “Emile Hirsch”),
(68, “Emma Stone”),
(69, “Eric Bana”),
(70, “Essie Davis”),
(71, “Ethan Hawke”),
(72, “Evan Peters”),
(73, “Evangeline Lilly”),
(74, “Frances McDormand”),
(75, “Freddie Prinze Jr.”),
(76, “Gabrielle Union”),
(77, “Gael García Bernal”),
(78, “Gary Autrey”),
(79, “Gerard Butler”),
(80, “Gilbert Donahue”),
(81, “Glenn Close”),
(82, “Gugu Mbatha-Raw”),
(83, “Hayden Christensen”),
(84, “Hayley McElhinney”),
(85, “Henry Cavill”),
(86, “Henry Golding”),
(87, “Hugh Bonneville”),
(88, “Hugh Dancy”),
(89, “Hugh Grant”),
(90, “Ido Tako”),
(91, “Idris Elba”),
(92, “Iko Uwais”),
(93, “Isaac Wang”),
(94, “Jack Black”),
(95, “Jack Whitehall”),
(96, “James Corden”),
(97, “James Franco”),
(98, “James Maslow”),
(99, “James McAvoy”),
(100, “Jan Rader”),
(101, “Janel Parrish”),
(102, “Jason Bateman”),
(103, “Jason Clarke”),
(104, “Jason Segel”),
(105, “Jason Sudeikis”),
(106, “Jennifer Aniston”),
(107, “Jenny Slate”),
(108, “Jesse Eisenberg”),
(109, “Jesse Gervasi”),
(110, “Jessica Louise Parkinson”),
(111, “Joe Costa”),
(112, “John Bisignano”),
(113, “John Mulaney”),
(114, “Johnny Depp”),
(115, “Jon Brion”),
(116, “Jon Hamm”),
(117, “Jonah Hill”),
(118, “Jonathan Hyde”),
(119, “Jordan Fisher”),
(120, “Jose Coronado”),
(121, “Juancho Hernangomez”),
(122, “Julia Roberts”),
(123, “Julia Wieniawa-Narkiewicz”),
(124, “Julie Benz”),
(125, “Julie Bowen”),
(126, “Juliette Lewis”),
(127, “Jun Kunimura”),
(128, “Justin Baldoni”),
(129,“Justin Timberlake”),
(130, “Katie Holmes”),
(131, “Katrina Kaif”),
(132, “Keira Knightley”),
(133, “Kendall Schmidt”),
(134, “Kevin Hart”),
(135, “Kevin James”),
(136, “Khalid Farah”),
(137, “Kiernan Shipka”),
(138, “Kimberly Clark”),
(139, “Kirsten Dunst”),
(140, “Kristen Wiig”),
(141, “Kumail Nanjiani”),
(142, “Kurt Russell”),
(143, “LaKeith Stanfield”),
(144, “Lana Condor”),
(145, “Laura Dern”),
(146, “Lauren Cohan”),
(147, “Leslie Bibb”),
(148, “Liam Hemsworth”),
(149, “Liam Neeson”),
(150, “Lisa Boyle”),
(151, “Loretta Devine”),
(152, “Lucas Black”),
(153, “Luke Evans”),
(154, “Luke Hawker”),
(155, “Luke Hemsworth”),
(156, “Macaulay Culkin”),
(157, “Maddie Lenton”),
(158, “Maggie Gyllenhaal”),
(159, “Marc Blucas”),
(160, “Margaret Qualley”),
(161, “Mark Wahlberg”),
(162, “Martin Lawrence”),
(163, “Matt Dillon”),
(164, “Matthew Broderick”),
(165, “Matthew David Morrell”),
(166, “Matthew Lillard”),
(167, “Matthew Macfadyen”),
(168, “Maya Hawke”),
(169, “Mia Sara”),
(170, “Michael Cera”),
(171, “Michael Jordan”),
(172, “Michael Keaton”),
(173, “Michael Whitehall”),
(174, “Michelle Pfeiffer”),
(175, “Michelle Rodriguez”),
(176, “Michiel Huisman”),
(177, “Mike Vogel”),
(178, “Mila Kunis”),
(179, “Millie Bobby Brown”),
(180, “Miranda Otto”),
(181, “Morgan Freeman”),
(182, “Naomi Watts”),
(183, “Nat Wolff”),
(184, “Nathalie Kelley”),
(185, “Neal Cantin”),
(186, “Necia Freeman”),
(187, “Nicholas Hoult”),
(188, “Nick Purcha”),
(189, “Noa Cohen”),
(190, “Noah Centineo”),
(191, “Noah Wiseman”),
(192, “Noomi Rapace”),
(193, “Octavia Spencer”),
(194, “Odeya Rush”),
(195, “Oliver Hudson”),
(196, “Ophelia Lovibond”),
(197, “Owen Atlas”),
(198, “Pat Morita”),
(199, “Patricia Clarkson”),
(200, “Patricia Keller”),
(201, “Paul Walker”),
(202, “Penn Badgley”),
(203, “Petunia”),
(204, “Pierre Coffin”),
(205, “Pim Bongaerts”),
(206, “Piotr Cyrwus”),
(207, “Queen Latifah”),
(208, “Rachel Weisz”),
(209, “Rafe Spall”),
(210, “Ralph Fiennes”),
(211, “Ralph Macchio”),
(212, “Rebecca Ferguson”),
(213, “Reginaldo Leme”),
(214, “Richard E. Grant”),
(215, “Robert James-Collier”),
(216, “Robyn Lively”),
(217, “Rosario Dawson”),
(218, “Rose Byrne”),
(219, “Russell Brand”),
(220, “Russell Crowe”),
(221, “Ryan Reynolds”),
(222, “Sacha Baron Cohen”),
(223, “Sam Claflin”),
(224, “Sam Worthington”),
(225, “Sandra Bullock”),
(226, “Saoirse Ronan”),
(227, “Sarah Michelle Gellar”),
(228, “Sebastian Dela”),
(229, “Shah Rukh Khan”),
(230,“Sofia Carson”),
(231, “Stanley Tucci”),
(232, “Stephen James”),
(233, “Steve Buscemi”),
(234, “Steve Carell”),
(235, “Sung Kang”),
(236, “Sylvester Stallone”),
(237, “Taron Egerton”),
(238, “Theodore Arthur”),
(239, “Theresa Randle”),
(240, “Tia Alkerdi”),
(241, “Tilda Cobham-Hervey”),
(242, “Timothee Chalamet”),
(243, “Tobey Maguire”),
(244, “Tom Hardy”),
(245, “Trasi Gazal”),
(246, “Tyler Perry”),
(247, “Val Kilmer”),
(248, “Vin Diesel”),
(249, “Wayne Knight”),
(250, “Will Smith”),
(251, “Willem Dafoe”),
(252, “Woody Harrelson”),
(253, “Zendaya”),
(254, “Zion Clark”)



-- update (CRUD) random examples for each table
-- update movie rating for a specific movie
UPDATE Movie 
SET AudienceRec = "R"
WHERE Title = 'Zion';

-- update the actor's name if there's a change
UPDATE Actor 
SET Actor1 = 'Adam Sandler' 
WHERE ActorID = 'A1';

-- update director name if there's a change
UPDATE Director 
SET Director = 'Denis Villeneuve' 
WHERE DirectorID = 'D1';

-- update genre name if there's a reclassification
UPDATE Genre 
SET Genre = 'Sci-Fi' 
WHERE GenreID = 'G10';

#Return Netflix Original movies
select M.Title as "Netflix Originals"
from Movie as M
join Production as P on M.MovieID = P.MovieID
where P.DistributionCompany = "Netflix";

#Return movie title with specific actor
select M.Title as "Movies with Adam Sandler"
from Movie as M
join Actor as A on M.MovieID = A.MovieID
where A.Actor1 = 'Adam Sandler' 
   or A.Actor2 = 'Adam Sandler' 
   or A.Actor3 = 'Adam Sandler';

#Return movie with highest rating in each genre
select M.Title, G.Genre, max(M.MovieRating) as MovieRating
from Movie as M
join Genre as G on M.MovieID = G.MovieID
group by G.Genre;

#Return movies that share a director
select M.Title, P.Director
from Movie as M, Production as P
where M.MovieID = P.MovieID and P.Director in (
	select P.Director
    from Production as P
    join Movie as M on M.MovieID = P.MovieID
    group by P.Director
    having count(M.MovieID) > 1
)
order by P.Director asc;

#Return oldest movies from each audience recommendation
select M.Title, M.AudienceRec, M.ReleaseYear
from Movie as M
where M.ReleaseYear = (
    select MIN(ReleaseYear)
    from Movie
    where AudienceRec = M.AudienceRec
)
order by M.AudienceRec asc;

-- max and min (newest and oldest movies)
SELECT Title, ReleaseYear
FROM Movie
WHERE ReleaseYear = (SELECT MIN(ReleaseYear) FROM Movie)
   OR ReleaseYear = (SELECT MAX(ReleaseYear) FROM Movie);
   
-- directors with the highest avg movie ratings   
SELECT P.Director, ROUND(AVG(M.MovieRating), 2) AS AvgRating, COUNT(M.MovieID) AS MovieCount
FROM Movie M
JOIN Production P ON M.MovieID = P.MovieID
GROUP BY P.Director
HAVING COUNT(M.MovieID) >= 2
ORDER BY AvgRating DESC
LIMIT 10;

-- most frequent actor in the database
SELECT ActorName, COUNT(*) AS MovieCount
FROM (
    SELECT A.Actor1 AS ActorName
    FROM Movie M
    JOIN Actor A ON M.MovieID = A.MovieID
    UNION ALL
    SELECT A.Actor2
    FROM Movie M
    JOIN Actor A ON M.MovieID = A.MovieID
    UNION ALL
    SELECT A.Actor3
    FROM Movie M
    JOIN Actor A ON M.MovieID = A.MovieID
) AS AllActors
WHERE ActorName IS NOT NULL
GROUP BY ActorName
ORDER BY MovieCount DESC
LIMIT 1;

-- actors in the most high-rated movies
SELECT A.Actor1, A.Actor2, A.Actor3, M.Title, M.MovieRating
FROM Movie M
JOIN Actor A ON M.MovieID = A.MovieID
WHERE M.MovieRating > 7.0
ORDER BY M.MovieRating DESC
LIMIT 10;

-- most popular genre among highly rated movies
SELECT G.Genre, COUNT(M.MovieID) AS HighRatedCount
FROM Movie M
JOIN Genre G ON M.MovieID = G.MovieID
WHERE M.MovieRating > 8.0
GROUP BY G.Genre
ORDER BY HighRatedCount DESC
LIMIT 10;

-- Return movies with specific Genre
SELECT M.Title
FROM Movie M
JOIN Genre G ON M.MovieID = G.MovieID
WHERE G.Genre = 'Comedy'
ORDER BY M.Title;

-- Return movies that were released from a specifc year and later (ordered in ascending order from oldest to newest release on or after 2000) (NOTE: to order it in descending order just change ASC to DESC)
SELECT M.Title, M.ReleaseYear
FROM Movie M
WHERE ReleaseYear >= 2000
ORDER BY ReleaseYear ASC;

-- Return all the info on a specific movieID (left join, nested query) 
SELECT
   M.MovieID, M.Title, M.ReleaseYear, M.MovieRating, M.AudienceRec,
   A.Actor1, A.Actor2, A.Actor3,
   P.Director,
   G.Genre
FROM Movie M
LEFT JOIN Actor A ON M.MovieID = A.MovieID
LEFT JOIN Production P ON M.MovieID = P.MovieID
LEFT JOIN Genre G ON M.MovieID = G.MovieID
WHERE M.MovieID =(
  SELECT MovieID
  FROM Movie
  WHERE MovieID = 11
);

-- Return movies with a specific MovieRating and above (example will be with <= 5.0) and with a specific audience rec(TV-MA)
SELECT M.Title, M.ReleaseYear, M.MovieRating, M.AudienceRec
FROM Movie M
WHERE M.MovieRating >= 5.0 AND M.AudienceRec = 'TV-MA'
ORDER BY M.MovieRating DESC;


-- Return movies that were released before a specicif year and with a specific genre and audienceRec
SELECT M.Title, M.ReleaseYear, M.MovieRating, M.AudienceRec, G.Genre
FROM Movie M
JOIN Genre G ON M.MovieID = G.MovieID
WHERE M.MovieID IN (
  SELECT M2.MovieID
  FROM Movie M2
  JOIN Genre G2 ON M2.MovieID = G2.MovieID
  WHERE M2.ReleaseYear > 2010
    AND M2.AudienceRec = 'R'
    AND G2.Genre = 'Comedy'
)
ORDER BY M.ReleaseYear ASC;

#and then this would be in the query: (creates a delte cascade that deletes all references to that movie)
DELETE FROM Movie WHERE MovieID = 10;

    
